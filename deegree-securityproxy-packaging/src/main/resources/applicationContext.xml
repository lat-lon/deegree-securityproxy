<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:security="http://www.springframework.org/schema/security"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
  http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

  <context:property-placeholder location="file:${PROXY_CONFIG}/config.properties"/>
  <context:annotation-config/>
  <import resource="securityContext.xml"/>
  <import resource="persistenceContext.xml"/>
  <import resource="wcsContext.xml"/>

  <bean id="serviceExceptionHandler" class="org.deegree.securityproxy.ServiceExceptionHandler">
    <constructor-arg value="${exception_file_path}"/>
    <constructor-arg value="${authentication_denied_status_code}"/>
    <constructor-arg value="${authorization_denied_status_code}"/>
  </bean>

  <bean name="log4JReportLogger" class="org.deegree.securityproxy.logger.Log4jSecurityRequestResponseLogger">
    <constructor-arg type="java.lang.String">
      <value>PROXY_CONFIG</value>
    </constructor-arg>
    <constructor-arg type="java.lang.String">
      <value>log4j.properties</value>
    </constructor-arg>
  </bean>

  <bean name="authenticationProvider"
        class="org.deegree.securityproxy.authentication.HeaderTokenAuthenticationProvider"/>

  <bean id="headerFilter"
        class="org.springframework.security.web.authentication.preauth.RequestHeaderAuthenticationFilter">
    <property name="principalRequestHeader" value="${access_token_header_field_name}"/>
    <property name="authenticationManager" ref="authenticationManager"/>
    <property name="exceptionIfHeaderMissing" value="false"/>
  </bean>

  <bean id="securityFilter" class="org.deegree.securityproxy.filter.SecurityFilter">
    <constructor-arg ref="serviceManagers"/>
    <constructor-arg ref="log4JReportLogger"/>
    <constructor-arg ref="log4JReportLogger"/>
  </bean>

  <bean id="serviceManagers" class="java.util.ArrayList">
    <constructor-arg>
      <list>
        <ref bean="wcsServiceManager"/>
      </list>
    </constructor-arg>
  </bean>

</beans>